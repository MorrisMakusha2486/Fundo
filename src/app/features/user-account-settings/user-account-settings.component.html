<!-- User Account Settings Component -->
<div class="flex min-h-screen bg-gray-50">
    <!-- Left Profile Section (30%) -->
    <div class="w-full md:w-3/10 bg-white shadow-lg relative">
      <!-- Blue Background Header -->
      <div class="bg-gradient-to-b from-blue-600 to-blue-500 h-48 w-full rounded-b-xl"></div>
      
      <!-- Profile Image -->
      <div class="flex flex-col items-center relative -mt-16">
        <div class="relative">
          <img 
            [src]="user.profileImage || 'assets/images/default-avatar.png'" 
            alt="Profile picture" 
            class="w-32 h-32 rounded-md object-cover border-4 border-white shadow-lg bg-white"
          >
          <button 
            class="absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 p-2 rounded-full text-white shadow-md transition-colors"
            (click)="openImageUploader()">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
          </button>
          <!-- Hidden File Input -->
          <input 
            type="file" 
            class="hidden" 
            #imageInput
            accept="image/*" 
            (change)="onImageSelected($event)"
          >
        </div>
        
        <!-- Username -->
        <h2 class="mt-4 text-xl font-bold text-gray-800">{{ user.username }}</h2>
        <span class="text-sm text-gray-500">Member since {{ user.createdAt | date:'MMMM yyyy' }}</span>
        
        <!-- Verification Badge -->
        <div *ngIf="user.verified" class="mt-2 flex items-center px-3 py-1 bg-green-100 rounded-full">
          <svg class="w-4 h-4 text-green-600 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          <span class="text-xs font-medium text-green-800">Verified Account</span>
        </div>
      </div>
      
      <!-- User Info List -->
      <div class="mt-8 px-6">
        <div class="border-b border-gray-200 pb-4">
          <h3 class="text-xs text-gray-500 uppercase tracking-wider mb-3">Personal Information</h3>
          
          <!-- Full Name -->
          <div class="mb-4">
            <div class="text-sm font-medium text-gray-600 mb-1">Full Name</div>
            <div class="text-base text-gray-900">{{ user.firstName }} {{ user.lastName }}</div>
          </div>
          
          <!-- Email -->
          <div class="mb-4">
            <div class="text-sm font-medium text-gray-600 mb-1">Email Address</div>
            <div class="flex items-center">
              <span class="text-base text-gray-900">{{ user.email }}</span>
              <span *ngIf="user.emailVerified" class="ml-2 px-2 py-0.5 bg-blue-100 text-xs text-blue-800 rounded-full">Verified</span>
            </div>
          </div>
          
          <!-- Phone -->
          <div class="mb-4">
            <div class="text-sm font-medium text-gray-600 mb-1">Phone Number</div>
            <div class="flex items-center">
              <span class="text-base text-gray-900">{{ user.phone || 'Not added yet' }}</span>
              <span *ngIf="user.phoneVerified" class="ml-2 px-2 py-0.5 bg-blue-100 text-xs text-blue-800 rounded-full">Verified</span>
            </div>
          </div>
          
          <!-- Address -->
          <div class="mb-4">
            <div class="text-sm font-medium text-gray-600 mb-1">Address</div>
            <div class="text-base text-gray-900">
              {{ user.address?.street || 'No address added' }}<br *ngIf="user.address?.street">
              {{ user.address?.city && user.address?.state ? (user.address?.city + ', ' + user.address?.state) : '' }}<br *ngIf="user.address?.city">
              {{ user.address?.zipCode }} {{ user.address?.country }}
            </div>
          </div>
          
          <!-- Additional Info -->
          <div class="mb-4">
            <div class="text-sm font-medium text-gray-600 mb-1">Date of Birth</div>
            <div class="text-base text-gray-900">{{ user.dateOfBirth | date:'mediumDate' }}</div>
          </div>
          
          <div class="mb-4">
            <div class="text-sm font-medium text-gray-600 mb-1">Gender</div>
            <div class="text-base text-gray-900">{{ user.gender || 'Not specified' }}</div>
          </div>
        </div>
        
        <!-- Quick Actions -->
        <div class="py-4">
          <h3 class="text-xs text-gray-500 uppercase tracking-wider mb-3">Quick Actions</h3>
          
          <button 
            (click)="openPasswordChange()"
            class="w-full flex items-center justify-center px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors mb-3">
            <svg class="mr-2 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
            </svg>
            Change Password
          </button>
          
          <button 
            (click)="toggleTwoFactorAuth()"
            class="w-full flex items-center justify-center px-4 py-2 text-sm font-medium text-blue-600 bg-blue-100 rounded-md hover:bg-blue-200 transition-colors">
            <svg class="mr-2 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
            </svg>
            {{ user.twoFactorEnabled ? 'Disable' : 'Enable' }} Two-Factor Authentication
          </button>
        </div>
        
        <!-- Account Stats -->
        <div class="pt-2">
          <div class="flex justify-between items-center mb-2 text-sm">
            <span class="text-gray-600">Account Age</span>
            <span class="text-gray-900">{{ accountAge }} days</span>
          </div>
          <div class="flex justify-between items-center mb-2 text-sm">
            <span class="text-gray-600">Last Login</span>
            <span class="text-gray-900">{{ user.lastLogin | date:'medium' }}</span>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Right Content Area (70%) -->
    <div class="hidden md:block w-7/10 bg-gray-50 p-8">
      <!-- Tabs Navigation -->
      <div class="border-b border-gray-200 mb-8">
        <nav class="-mb-px flex space-x-8">
          <button 
            *ngFor="let tab of tabs" 
            (click)="activeTab = tab.id"
            class="py-4 px-1 border-b-2 font-medium text-sm transition-colors"
            [class.text-blue-600]="activeTab === tab.id" 
            [class.border-blue-600]="activeTab === tab.id"
            [class.text-gray-500]="activeTab !== tab.id" 
            [class.border-transparent]="activeTab !== tab.id">
            {{ tab.label }}
          </button>
        </nav>
      </div>
      
      <!-- Edit Profile Form (Active by Default) -->
      <div *ngIf="activeTab === 'profile'" class="bg-white shadow-sm rounded-lg p-6">
        <h2 class="text-xl font-bold text-gray-800 mb-6">Edit Profile Information</h2>
        
        <form (ngSubmit)="saveProfile()" [formGroup]="profileForm" class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- First Name -->
          <div>
            <label for="firstName" class="block text-sm font-medium text-gray-700 mb-1">First Name</label>
            <input 
              type="text" 
              id="firstName" 
              formControlName="firstName"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
            <div *ngIf="profileForm.get('firstName')?.invalid && profileForm.get('firstName')?.touched" class="text-red-600 text-xs mt-1">
              First name is required
            </div>
          </div>
          
          <!-- Last Name -->
          <div>
            <label for="lastName" class="block text-sm font-medium text-gray-700 mb-1">Last Name</label>
            <input 
              type="text" 
              id="lastName" 
              formControlName="lastName"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
            <div *ngIf="profileForm.get('lastName')?.invalid && profileForm.get('lastName')?.touched" class="text-red-600 text-xs mt-1">
              Last name is required
            </div>
          </div>
          
          <!-- Email -->
          <div>
            <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email Address</label>
            <div class="relative">
              <input 
                type="email" 
                id="email" 
                formControlName="email"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" 
                [class.pr-10]="user.emailVerified">
              <div *ngIf="user.emailVerified" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                <svg class="h-5 w-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
              </div>
            </div>
            <div *ngIf="profileForm.get('email')?.invalid && profileForm.get('email')?.touched" class="text-red-600 text-xs mt-1">
              Please enter a valid email address
            </div>
          </div>
          
          <!-- Phone -->
          <div>
            <label for="phone" class="block text-sm font-medium text-gray-700 mb-1">Phone Number</label>
            <div class="relative">
              <input 
                type="tel" 
                id="phone" 
                formControlName="phone"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                [class.pr-10]="user.phoneVerified">
              <div *ngIf="user.phoneVerified" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                <svg class="h-5 w-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
              </div>
            </div>
            <div *ngIf="!user.phoneVerified && profileForm.value.phone" class="flex mt-1">
              <button type="button" (click)="verifyPhone()" class="text-blue-600 text-xs">Verify phone number</button>
            </div>
          </div>
          
          <!-- Date of Birth -->
          <div>
            <label for="dateOfBirth" class="block text-sm font-medium text-gray-700 mb-1">Date of Birth</label>
            <input 
              type="date" 
              id="dateOfBirth" 
              formControlName="dateOfBirth"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
          
          <!-- Gender -->
          <div>
            <label for="gender" class="block text-sm font-medium text-gray-700 mb-1">Gender</label>
            <select 
              id="gender" 
              formControlName="gender"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
              <option value="">Prefer not to say</option>
              <option value="male">Male</option>
              <option value="female">Female</option>
              <option value="other">Other</option>
            </select>
          </div>
          
          <!-- Address Section -->
          <div class="col-span-1 md:col-span-2">
            <h3 class="text-lg font-medium text-gray-800 mb-3 border-b pb-2">Address Information</h3>
          </div>
          
          <!-- Street -->
          <div class="col-span-1 md:col-span-2">
            <label for="street" class="block text-sm font-medium text-gray-700 mb-1">Street Address</label>
            <input 
              type="text" 
              id="street" 
              formControlName="street"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
          
          <!-- City -->
          <div>
            <label for="city" class="block text-sm font-medium text-gray-700 mb-1">City</label>
            <input 
              type="text" 
              id="city" 
              formControlName="city"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
          
          <!-- State -->
          <div>
            <label for="state" class="block text-sm font-medium text-gray-700 mb-1">State/Province</label>
            <input 
              type="text" 
              id="state" 
              formControlName="state"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
          
          <!-- Zip Code -->
          <div>
            <label for="zipCode" class="block text-sm font-medium text-gray-700 mb-1">ZIP/Postal Code</label>
            <input 
              type="text" 
              id="zipCode" 
              formControlName="zipCode"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
          
          <!-- Country -->
          <div>
            <label for="country" class="block text-sm font-medium text-gray-700 mb-1">Country</label>
            <select 
              id="country" 
              formControlName="country"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
              <option value="">Select Country</option>
              <option *ngFor="let country of countries" [value]="country">{{ country }}</option>
            </select>
          </div>
          
          <!-- Save Button -->
          <div class="col-span-1 md:col-span-2 flex justify-end mt-4">
            <button 
              type="button" 
              (click)="resetForm()" 
              class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 mr-3">
              Cancel
            </button>
            <button 
              type="submit" 
              class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
              [disabled]="profileForm.invalid || !profileForm.dirty">
              <span *ngIf="saving">Saving...</span>
              <span *ngIf="!saving">Save Changes</span>
            </button>
          </div>
        </form>
      </div>
      
      <!-- Security Settings Tab Content -->
      <div *ngIf="activeTab === 'security'" class="bg-white shadow-sm rounded-lg divide-y divide-gray-200">
        <!-- Password Section -->
        <div class="p-6">
          <h3 class="text-lg font-medium text-gray-800 mb-4">Password Management</h3>
          <form [formGroup]="passwordForm" (ngSubmit)="changePassword()" class="space-y-4">
            <div>
              <label for="currentPassword" class="block text-sm font-medium text-gray-700 mb-1">Current Password</label>
              <input 
                type="password" 
                id="currentPassword" 
                formControlName="currentPassword"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
              <div *ngIf="passwordForm.get('currentPassword')?.invalid && passwordForm.get('currentPassword')?.touched" class="text-red-600 text-xs mt-1">
                Current password is required
              </div>
            </div>
            
            <div>
              <label for="newPassword" class="block text-sm font-medium text-gray-700 mb-1">New Password</label>
              <input 
                type="password" 
                id="newPassword" 
                formControlName="newPassword"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
              <div *ngIf="passwordForm.get('newPassword')?.invalid && passwordForm.get('newPassword')?.touched" class="text-red-600 text-xs mt-1">
                Password must be at least 8 characters
              </div>
            </div>
            
            <div>
              <label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-1">Confirm New Password</label>
              <input 
                type="password" 
                id="confirmPassword" 
                formControlName="confirmPassword"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
              <div *ngIf="passwordForm.errors?.['passwordMismatch'] && passwordForm.get('confirmPassword')?.touched" class="text-red-600 text-xs mt-1">
                Passwords do not match
              </div>
            </div>
            
            <div class="pt-2">
              <button 
                type="submit" 
                class="w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
                [disabled]="passwordForm.invalid">
                Update Password
              </button>
            </div>
          </form>
        </div>
        
        <!-- Two-Factor Authentication -->
        <div class="p-6">
          <div class="flex justify-between items-center">
            <div>
              <h3 class="text-lg font-medium text-gray-800">Two-Factor Authentication</h3>
              <p class="text-sm text-gray-500 mt-1">Add an extra layer of security to your account</p>
            </div>
            <div class="flex items-center">
              <span class="mr-3 text-sm" [class.text-green-600]="user.twoFactorEnabled" [class.text-gray-500]="!user.twoFactorEnabled">
                {{ user.twoFactorEnabled ? 'Enabled' : 'Disabled' }}
              </span>
              <label class="relative inline-flex items-center cursor-pointer">
                <input 
                  type="checkbox" 
                  [checked]="user.twoFactorEnabled" 
                  (change)="toggleTwoFactorAuth()" 
                  class="sr-only peer">
                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
              </label>
            </div>
          </div>
        </div>
        
        <!-- Connected Devices -->
        <div class="p-6">
          <h3 class="text-lg font-medium text-gray-800 mb-4">Connected Devices</h3>
          <div class="space-y-4">
            <div *ngFor="let device of connectedDevices" class="flex justify-between items-center">
              <div class="flex items-center">
                <div class="bg-gray-100 p-2 rounded-md mr-4">
                  <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path *ngIf="device.type === 'desktop'" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                    <path *ngIf="device.type === 'mobile'" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                    <path *ngIf="device.type === 'tablet'" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                  </svg>
                </div>
                <div>
                  <div class="text-sm font-medium text-gray-800">{{ device.name }}</div>
                  <div class="text-xs text-gray-500">Last active: {{ device.lastActive | date:'medium' }}</div>
                  <div class="text-xs text-gray-500">{{ device.location }}</div>
                </div>
              </div>
              <button 
                *ngIf="!device.current"
                (click)="logoutDevice(device.id)" 
                class="text-sm text-red-600 hover:text-red-800">
                Log out
              </button>
              <span *ngIf="device.current" class="text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded-full">Current</span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Notification Preferences Tab -->
      <div *ngIf="activeTab === 'notifications'" class="bg-white shadow-sm rounded-lg p-6">
        <h2 class="text-xl font-bold text-gray-800 mb-6">Notification Preferences</h2>
        
        <div class="space-y-6">
          <div *ngFor="let category of notificationCategories" class="pb-5 border-b border-gray-200 last:border-0 last:pb-0">
            <h3 class="text-lg font-medium text-gray-800 mb-3">{{ category.title }}</h3>
            <div class="space-y-4">
              <div *ngFor="let option of category.options" class="flex items-center justify-between">
                <div>
                  <h4 class="text-sm font-medium text-gray-800">{{ option.title }}</h4>
                  <p class="text-xs text-gray-500">{{ option.description }}</p>
                </div>
                <div class="flex items-center space-x-4">
                  <!-- Email checkbox -->
                  <div class="flex items-center" *ngIf="option.channels.includes('email')">
                    <input 
                      type="checkbox"
                      [(ngModel)]="option.emailEnabled" 
                      [id]="'email-' + option.id"
                      class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                    <label [for]="'email-' + option.id" class="ml-2 text-xs text-gray-600">Email</label>
                  </div>
                  
                  <!-- Push checkbox -->
                  <div class="flex items-center" *ngIf="option.channels.includes('push')">
                    <input 
                      type="checkbox"
                      [(ngModel)]="option.pushEnabled" 
                      [id]="'push-' + option.id"
                      class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                    <label [for]="'push-' + option.id" class="ml-2 text-xs text-gray-600">Push</label>
                  </div>
                  
                  <!-- SMS checkbox -->
                  <div class="flex items-center" *ngIf="option.channels.includes('sms')">
                    <input 
                      type="checkbox"
                      [(ngModel)]="option.smsEnabled" 
                      [id]="'sms-' + option.id"
                      class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                    <label [for]="'sms-' + option.id" class="ml-2 text-xs text-gray-600">SMS</label>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Save Notification Settings -->
        <div class="mt-6 flex justify-end">
          <button 
            (click)="saveNotificationSettings()"
            class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
            Save Notification Settings
          </button>
        </div>
      </div>
      
      <!-- Privacy Settings Tab -->
      <div *ngIf="activeTab === 'privacy'" class="bg-white shadow-sm rounded-lg p-6">
        <h2 class="text-xl font-bold text-gray-800 mb-6">Privacy Settings</h2>
        
        <div class="space-y-6">
          <!-- Profile Privacy -->
          <div class="pb-5 border-b border-gray-200">
            <h3 class="text-lg font-medium text-gray-800 mb-3">Profile Visibility</h3>
            <div class="space-y-3">
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="text-sm font-medium text-gray-800">Public Profile</h4>
                  <p class="text-xs text-gray-500">Show your profile to all users</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input 
                    type="checkbox" 
                    [(ngModel)]="privacySettings.publicProfile" 
                    class="sr-only peer">
                  <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                </label>
              </div>
              
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="text-sm font-medium text-gray-800">Show Learning Activity</h4>
                  <p class="text-xs text-gray-500">Let others see your courses and achievements</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input 
                    type="checkbox" 
                    [(ngModel)]="privacySettings.showLearningActivity" 
                    class="sr-only peer">
                  <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                </label>
              </div>
              
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="text-sm font-medium text-gray-800">Online Status</h4>
                  <p class="text-xs text-gray-500">Show when you're active on the platform</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input 
                    type="checkbox" 
                    [(ngModel)]="privacySettings.onlineStatus" 
                    class="sr-only peer">
                  <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                </label>
              </div>
            </div>
          </div>
          
          <!-- Data Usage -->
          <div class="pb-5 border-b border-gray-200">
            <h3 class="text-lg font-medium text-gray-800 mb-3">Data Usage</h3>
            <div class="space-y-3">
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="text-sm font-medium text-gray-800">Personalization</h4>
                  <p class="text-xs text-gray-500">Allow us to personalize your learning experience based on your activity</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input 
                    type="checkbox" 
                    [(ngModel)]="privacySettings.personalization" 
                    class="sr-only peer">
                  <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                </label>
              </div>
              
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="text-sm font-medium text-gray-800">Analytics</h4>
                  <p class="text-xs text-gray-500">Allow us to use analytics cookies to improve our services</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input 
                    type="checkbox" 
                    [(ngModel)]="privacySettings.analytics" 
                    class="sr-only peer">
                  <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                </label>
              </div>
            </div>
          </div>
          
          <!-- Delete Account -->
          <div class="pt-2">
            <h3 class="text-lg font-medium text-gray-800 mb-3">Account Management</h3>
            <p class="text-sm text-gray-600 mb-4">
              Deleting your account will remove all of your information from our database. This cannot be undone.
            </p>
            <button 
              (click)="openDeleteAccountModal()"
              class="px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500">
              Delete Account
            </button>
          </div>
        </div>
        
        <!-- Save Privacy Settings -->
        <div class="mt-8 flex justify-end">
          <button 
            (click)="savePrivacySettings()"
            class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
            Save Privacy Settings
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Password Change Modal -->
  <div *ngIf="showPasswordModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-md">
      <div class="p-6 border-b border-gray-200">
        <h3 class="text-lg font-medium text-gray-900">Change Password</h3>
      </div>
      <div class="p-6">
        <form [formGroup]="passwordForm" (ngSubmit)="changePassword()" class="space-y-4">
          <div>
            <label for="currentPassword" class="block text-sm font-medium text-gray-700 mb-1">Current Password</label>
            <input 
              type="password" 
              id="currentPassword" 
              formControlName="currentPassword"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
            <div *ngIf="passwordForm.get('currentPassword')?.invalid && passwordForm.get('currentPassword')?.touched" class="text-red-600 text-xs mt-1">
              Current password is required
            </div>
          </div>
          
          <div>
            <!-- User Account Settings Component -->
  <div class="flex min-h-screen bg-gray-50">
    <!-- Left Profile Section (30%) -->
    <div class="w-full md:w-3/10 bg-white shadow-lg relative">
      <!-- Blue Background Header -->
      <div class="bg-gradient-to-b from-blue-600 to-blue-500 h-48 w-full rounded-b-xl"></div>
      
      <!-- Profile Image -->
      <div class="flex flex-col items-center relative -mt-16">
        <div class="relative">
          <img 
            [src]="user.profileImage || 'assets/images/default-avatar.png'" 
            alt="Profile picture" 
            class="w-32 h-32 rounded-md object-cover border-4 border-white shadow-lg bg-white"
          >
          <button 
            class="absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 p-2 rounded-full text-white shadow-md transition-colors"
            (click)="openImageUploader()">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
          </button>
          <!-- Hidden File Input -->
          <input 
            type="file" 
            class="hidden" 
            #imageInput
            accept="image/*" 
            (change)="onImageSelected($event)"
          >
        </div>
        
        <!-- Username -->
        <h2 class="mt-4 text-xl font-bold text-gray-800">{{ user.username }}</h2>
        <span class="text-sm text-gray-500">Member since {{ user.createdAt | date:'MMMM yyyy' }}</span>
        
        <!-- Verification Badge -->
        <div *ngIf="user.verified" class="mt-2 flex items-center px-3 py-1 bg-green-100 rounded-full">
          <svg class="w-4 h-4 text-green-600 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          <span class="text-xs font-medium text-green-800">Verified Account</span>
        </div>
      </div>
      
      <!-- User Info List -->
      <div class="mt-8 px-6">
        <div class="border-b border-gray-200 pb-4">
          <h3 class="text-xs text-gray-500 uppercase tracking-wider mb-3">Personal Information</h3>
          
          <!-- Full Name -->
          <div class="mb-4">
            <div class="text-sm font-medium text-gray-600 mb-1">Full Name</div>
            <div class="text-base text-gray-900">{{ user.firstName }} {{ user.lastName }}</div>
          </div>
          
          <!-- Email -->
          <div class="mb-4">
            <div class="text-sm font-medium text-gray-600 mb-1">Email Address</div>
            <div class="flex items-center">
              <span class="text-base text-gray-900">{{ user.email }}</span>
              <span *ngIf="user.emailVerified" class="ml-2 px-2 py-0.5 bg-blue-100 text-xs text-blue-800 rounded-full">Verified</span>
            </div>
          </div>
          
          <!-- Phone -->
          <div class="mb-4">
            <div class="text-sm font-medium text-gray-600 mb-1">Phone Number</div>
            <div class="flex items-center">
              <span class="text-base text-gray-900">{{ user.phone || 'Not added yet' }}</span>
              <span *ngIf="user.phoneVerified" class="ml-2 px-2 py-0.5 bg-blue-100 text-xs text-blue-800 rounded-full">Verified</span>
            </div>
          </div>
          
          <!-- Address -->
          <div class="mb-4">
            <div class="text-sm font-medium text-gray-600 mb-1">Address</div>
            <div class="text-base text-gray-900">
              {{ user.address?.street || 'No address added' }}<br *ngIf="user.address?.street">
              {{ user.address?.city && user.address?.state ? (user.address?.city + ', ' + user.address?.state) : '' }}<br *ngIf="user.address?.city">
              {{ user.address?.zipCode }} {{ user.address?.country }}
            </div>
          </div>
          
          <!-- Additional Info -->
          <div class="mb-4">
            <div class="text-sm font-medium text-gray-600 mb-1">Date of Birth</div>
            <div class="text-base text-gray-900">{{ user.dateOfBirth | date:'mediumDate' }}</div>
          </div>
          
          <div class="mb-4">
            <div class="text-sm font-medium text-gray-600 mb-1">Gender</div>
            <div class="text-base text-gray-900">{{ user.gender || 'Not specified' }}</div>
          </div>
        </div>
        
        <!-- Quick Actions -->
        <div class="py-4">
          <h3 class="text-xs text-gray-500 uppercase tracking-wider mb-3">Quick Actions</h3>
          
          <button 
            (click)="openPasswordChange()"
            class="w-full flex items-center justify-center px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors mb-3">
            <svg class="mr-2 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
            </svg>
            Change Password
          </button>
          
          <button 
            (click)="toggleTwoFactorAuth()"
            class="w-full flex items-center justify-center px-4 py-2 text-sm font-medium text-blue-600 bg-blue-100 rounded-md hover:bg-blue-200 transition-colors">
            <svg class="mr-2 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
            </svg>
            {{ user.twoFactorEnabled ? 'Disable' : 'Enable' }} Two-Factor Authentication
          </button>
        </div>
        
        <!-- Account Stats -->
        <div class="pt-2">
          <div class="flex justify-between items-center mb-2 text-sm">
            <span class="text-gray-600">Account Age</span>
            <span class="text-gray-900">{{ accountAge }} days</span>
          </div>
          <div class="flex justify-between items-center mb-2 text-sm">
            <span class="text-gray-600">Last Login</span>
            <span class="text-gray-900">{{ user.lastLogin | date:'medium' }}</span>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Right Content Area (70%) -->
    <div class="hidden md:block w-7/10 bg-gray-50 p-8">
      <!-- Tabs Navigation -->
      <div class="border-b border-gray-200 mb-8">
        <nav class="-mb-px flex space-x-8">
          <button 
            *ngFor="let tab of tabs" 
            (click)="activeTab = tab.id"
            class="py-4 px-1 border-b-2 font-medium text-sm transition-colors"
            [class.text-blue-600]="activeTab === tab.id" 
            [class.border-blue-600]="activeTab === tab.id"
            [class.text-gray-500]="activeTab !== tab.id" 
            [class.border-transparent]="activeTab !== tab.id">
            {{ tab.label }}
          </button>
        </nav>
      </div>
      
      <!-- Edit Profile Form (Active by Default) -->
      <div *ngIf="activeTab === 'profile'" class="bg-white shadow-sm rounded-lg p-6">
        <h2 class="text-xl font-bold text-gray-800 mb-6">Edit Profile Information</h2>
        
        <form (ngSubmit)="saveProfile()" [formGroup]="profileForm" class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- First Name -->
          <div>
            <label for="firstName" class="block text-sm font-medium text-gray-700 mb-1">First Name</label>
            <input 
              type="text" 
              id="firstName" 
              formControlName="firstName"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
            <div *ngIf="profileForm.get('firstName')?.invalid && profileForm.get('firstName')?.touched" class="text-red-600 text-xs mt-1">
              First name is required
            </div>
          </div>
          
          <!-- Last Name -->
          <div>
            <label for="lastName" class="block text-sm font-medium text-gray-700 mb-1">Last Name</label>
            <input 
              type="text" 
              id="lastName" 
              formControlName="lastName"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
            <div *ngIf="profileForm.get('lastName')?.invalid && profileForm.get('lastName')?.touched" class="text-red-600 text-xs mt-1">
              Last name is required
            </div>
          </div>
          
          <!-- Email -->
          <div>
            <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email Address</label>
            <div class="relative">
              <input 
                type="email" 
                id="email" 
                formControlName="email"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" 
                [class.pr-10]="user.emailVerified">
              <div *ngIf="user.emailVerified" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                <svg class="h-5 w-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
              </div>
            </div>
            <div *ngIf="profileForm.get('email')?.invalid && profileForm.get('email')?.touched" class="text-red-600 text-xs mt-1">
              Please enter a valid email address
            </div>
          </div>
          
          <!-- Phone -->
          <div>
            <label for="phone" class="block text-sm font-medium text-gray-700 mb-1">Phone Number</label>
            <div class="relative">
              <input 
                type="tel" 
                id="phone" 
                formControlName="phone"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                [class.pr-10]="user.phoneVerified">
              <div *ngIf="user.phoneVerified" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                <svg class="h-5 w-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
              </div>
            </div>
            <div *ngIf="!user.phoneVerified && profileForm.value.phone" class="flex mt-1">
              <button type="button" (click)="verifyPhone()" class="text-blue-600 text-xs">Verify phone number</button>
            </div>
          </div>
          
          <!-- Date of Birth -->
          <div>
            <label for="dateOfBirth" class="block text-sm font-medium text-gray-700 mb-1">Date of Birth</label>
            <input 
              type="date" 
              id="dateOfBirth" 
              formControlName="dateOfBirth"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
          
          <!-- Gender -->
          <div>
            <label for="gender" class="block text-sm font-medium text-gray-700 mb-1">Gender</label>
            <select 
              id="gender" 
              formControlName="gender"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
              <option value="">Prefer not to say</option>
              <option value="male">Male</option>
              <option value="female">Female</option>
              <option value="other">Other</option>
            </select>
          </div>
          
          <!-- Address Section -->
          <div class="col-span-1 md:col-span-2">
            <h3 class="text-lg font-medium text-gray-800 mb-3 border-b pb-2">Address Information</h3>
          </div>
          
          <!-- Street -->
          <div class="col-span-1 md:col-span-2">
            <label for="street" class="block text-sm font-medium text-gray-700 mb-1">Street Address</label>
            <input 
              type="text" 
              id="street" 
              formControlName="street"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
          
          <!-- City -->
          <div>
            <label for="city" class="block text-sm font-medium text-gray-700 mb-1">City</label>
            <input 
              type="text" 
              id="city" 
              formControlName="city"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
          
          <!-- State -->
          <div>
            <label for="state" class="block text-sm font-medium text-gray-700 mb-1">State/Province</label>
            <input 
              type="text" 
              id="state" 
              formControlName="state"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
          
          <!-- Zip Code -->
          <div>
            <label for="zipCode" class="block text-sm font-medium text-gray-700 mb-1">ZIP/Postal Code</label>
            <input 
              type="text" 
              id="zipCode" 
              formControlName="zipCode"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
          
          <!-- Country -->
          <div>
            <label for="country" class="block text-sm font-medium text-gray-700 mb-1">Country</label>
            <select 
              id="country" 
              formControlName="country"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
              <option value="">Select Country</option>
              <option *ngFor="let country of countries" [value]="country">{{ country }}</option>
            </select>
          </div>
          
          <!-- Save Button -->
          <div class="col-span-1 md:col-span-2 flex justify-end mt-4">
            <button 
              type="button" 
              (click)="resetForm()" 
              class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 mr-3">
              Cancel
            </button>
            <button 
              type="submit" 
              class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
              [disabled]="profileForm.invalid || !profileForm.dirty">
              <span *ngIf="saving">Saving...</span>
              <span *ngIf="!saving">Save Changes</span>
            </button>
          </div>
        </form>
      </div>
      
      <!-- Security Settings Tab Content -->
      <div *ngIf="activeTab === 'security'" class="bg-white shadow-sm rounded-lg divide-y divide-gray-200">
        <!-- Password Section -->
        <div class="p-6">
          <h3 class="text-lg font-medium text-gray-800 mb-4">Password Management</h3>
          <form [formGroup]="passwordForm" (ngSubmit)="changePassword()" class="space-y-4">
            <div>
              <label for="currentPassword" class="block text-sm font-medium text-gray-700 mb-1">Current Password</label>
              <input 
                type="password" 
                id="currentPassword" 
                formControlName="currentPassword"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
              <div *ngIf="passwordForm.get('currentPassword')?.invalid && passwordForm.get('currentPassword')?.touched" class="text-red-600 text-xs mt-1">
                Current password is required
              </div>
            </div>
            
            <div>
              <label for="newPassword" class="block text-sm font-medium text-gray-700 mb-1">New Password</label>
              <input 
                type="password" 
                id="newPassword" 
                formControlName="newPassword"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
              <div *ngIf="passwordForm.get('newPassword')?.invalid && passwordForm.get('newPassword')?.touched" class="text-red-600 text-xs mt-1">
                Password must be at least 8 characters
              </div>
            </div>
            
            <div>
              <label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-1">Confirm New Password</label>
              <input 
                type="password" 
                id="confirmPassword" 
                formControlName="confirmPassword"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
              <div *ngIf="passwordForm.errors?.['passwordMismatch'] && passwordForm.get('confirmPassword')?.touched" class="text-red-600 text-xs mt-1">
                Passwords do not match
              </div>
            </div>
            
            <div class="pt-2">
              <button 
                type="submit" 
                class="w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
                [disabled]="passwordForm.invalid">
                Update Password
              </button>
            </div>
          </form>
        </div>
        
        <!-- Two-Factor Authentication -->
        <div class="p-6">
          <div class="flex justify-between items-center">
            <div>
              <h3 class="text-lg font-medium text-gray-800">Two-Factor Authentication</h3>
              <p class="text-sm text-gray-500 mt-1">Add an extra layer of security to your account</p>
            </div>
            <div class="flex items-center">
              <span class="mr-3 text-sm" [class.text-green-600]="user.twoFactorEnabled" [class.text-gray-500]="!user.twoFactorEnabled">
                {{ user.twoFactorEnabled ? 'Enabled' : 'Disabled' }}
              </span>
              <label class="relative inline-flex items-center cursor-pointer">
                <input 
                  type="checkbox" 
                  [checked]="user.twoFactorEnabled" 
                  (change)="toggleTwoFactorAuth()" 
                  class="sr-only peer">
                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
              </label>
            </div>
          </div>
        </div>
        
        <!-- Connected Devices -->
        <div class="p-6">
          <h3 class="text-lg font-medium text-gray-800 mb-4">Connected Devices</h3>
          <div class="space-y-4">
            <div *ngFor="let device of connectedDevices" class="flex justify-between items-center">
              <div class="flex items-center">
                <div class="bg-gray-100 p-2 rounded-md mr-4">
                  <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path *ngIf="device.type === 'desktop'" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                    <path *ngIf="device.type === 'mobile'" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                    <path *ngIf="device.type === 'tablet'" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                  </svg>
                </div>
                <div>
                  <div class="text-sm font-medium text-gray-800">{{ device.name }}</div>
                  <div class="text-xs text-gray-500">Last active: {{ device.lastActive | date:'medium' }}</div>
                  <div class="text-xs text-gray-500">{{ device.location }}</div>
                </div>
              </div>
              <button 
                *ngIf="!device.current"
                (click)="logoutDevice(device.id)" 
                class="text-sm text-red-600 hover:text-red-800">
                Log out
              </button>
              <span *ngIf="device.current" class="text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded-full">Current</span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Notification Preferences Tab -->
      <div *ngIf="activeTab === 'notifications'" class="bg-white shadow-sm rounded-lg p-6">
        <h2 class="text-xl font-bold text-gray-800 mb-6">Notification Preferences</h2>
        
        <div class="space-y-6">
          <div *ngFor="let category of notificationCategories" class="pb-5 border-b border-gray-200 last:border-0 last:pb-0">
            <h3 class="text-lg font-medium text-gray-800 mb-3">{{ category.title }}</h3>
            <div class="space-y-4">
              <div *ngFor="let option of category.options" class="flex items-center justify-between">
                <div>
                  <h4 class="text-sm font-medium text-gray-800">{{ option.title }}</h4>
                  <p class="text-xs text-gray-500">{{ option.description }}</p>
                </div>
                <div class="flex items-center space-x-4">
                  <!-- Email checkbox -->
                  <div class="flex items-center" *ngIf="option.channels.includes('email')">
                    <input 
                      type="checkbox"
                      [(ngModel)]="option.emailEnabled" 
                      [id]="'email-' + option.id"
                      class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                    <label [for]="'email-' + option.id" class="ml-2 text-xs text-gray-600">Email</label>
                  </div>
                  
                  <!-- Push checkbox -->
                  <div class="flex items-center" *ngIf="option.channels.includes('push')">
                    <input 
                      type="checkbox"
                      [(ngModel)]="option.pushEnabled" 
                      [id]="'push-' + option.id"
                      class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                    <label [for]="'push-' + option.id" class="ml-2 text-xs text-gray-600">Push</label>
                  </div>
                  
                  <!-- SMS checkbox -->
                  <div class="flex items-center" *ngIf="option.channels.includes('sms')">
                    <input 
                      type="checkbox"
                      [(ngModel)]="option.smsEnabled" 
                      [id]="'sms-' + option.id"
                      class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                    <label [for]="'sms-' + option.id" class="ml-2 text-xs text-gray-600">SMS</label>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Save Notification Settings -->
        <div class="mt-6 flex justify-end">
          <button 
            (click)="saveNotificationSettings()"
            class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
            Save Notification Settings
          </button>
        </div>
      </div>
      
      <!-- Privacy Settings Tab -->
      <div *ngIf="activeTab === 'privacy'" class="bg-white shadow-sm rounded-lg p-6">
        <h2 class="text-xl font-bold text-gray-800 mb-6">Privacy Settings</h2>
        
        <div class="space-y-6">
          <!-- Profile Privacy -->
          <div class="pb-5 border-b border-gray-200">
            <h3 class="text-lg font-medium text-gray-800 mb-3">Profile Visibility</h3>
            <div class="space-y-3">
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="text-sm font-medium text-gray-800">Public Profile</h4>
                  <p class="text-xs text-gray-500">Show your profile to all users</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input 
                    type="checkbox" 
                    [(ngModel)]="privacySettings.publicProfile" 
                    class="sr-only peer">
                  <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                </label>
              </div>
              
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="text-sm font-medium text-gray-800">Show Learning Activity</h4>
                  <p class="text-xs text-gray-500">Let others see your courses and achievements</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input 
                    type="checkbox" 
                    [(ngModel)]="privacySettings.showLearningActivity" 
                    class="sr-only peer">
                  <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                </label>
              </div>
              
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="text-sm font-medium text-gray-800">Online Status</h4>
                  <p class="text-xs text-gray-500">Show when you're active on the platform</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input 
                    type="checkbox" 
                    [(ngModel)]="privacySettings.onlineStatus" 
                    class="sr-only peer">
                  <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                </label>
              </div>
            </div>
          </div>
          
          <!-- Data Usage -->
          <div class="pb-5 border-b border-gray-200">
            <h3 class="text-lg font-medium text-gray-800 mb-3">Data Usage</h3>
            <div class="space-y-3">
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="text-sm font-medium text-gray-800">Personalization</h4>
                  <p class="text-xs text-gray-500">Allow us to personalize your learning experience based on your activity</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input 
                    type="checkbox" 
                    [(ngModel)]="privacySettings.personalization" 
                    class="sr-only peer">
                  <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                </label>
              </div>
              
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="text-sm font-medium text-gray-800">Analytics</h4>
                  <p class="text-xs text-gray-500">Allow us to use analytics cookies to improve our services</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input 
                    type="checkbox" 
                    [(ngModel)]="privacySettings.analytics" 
                    class="sr-only peer">
                  <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                </label>
              </div>
            </div>
          </div>
          
          <!-- Delete Account -->
          <div class="pt-2">
            <h3 class="text-lg font-medium text-gray-800 mb-3">Account Management</h3>
            <p class="text-sm text-gray-600 mb-4">
              Deleting your account will remove all of your information from our database. This cannot be undone.
            </p>
            <button 
              (click)="openDeleteAccountModal()"
              class="px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500">
              Delete Account
            </button>
          </div>
        </div>
        
        <!-- Save Privacy Settings -->
        <div class="mt-8 flex justify-end">
          <button 
            (click)="savePrivacySettings()"
            class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
            Save Privacy Settings
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Password Change Modal (continued) -->
<div *ngIf="showPasswordModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg shadow-xl w-full max-w-md">
    <div class="p-6 border-b border-gray-200">
      <h3 class="text-lg font-medium text-gray-900">Change Password</h3>
    </div>
    <div class="p-6">
      <form [formGroup]="passwordForm" (ngSubmit)="changePassword()" class="space-y-4">
        <div>
          <label for="modalCurrentPassword" class="block text-sm font-medium text-gray-700 mb-1">Current Password</label>
          <input 
            type="password" 
            id="modalCurrentPassword" 
            formControlName="currentPassword"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          <div *ngIf="passwordForm.get('currentPassword')?.invalid && passwordForm.get('currentPassword')?.touched" class="text-red-600 text-xs mt-1">
            Current password is required
          </div>
        </div>
        
        <div>
          <label for="modalNewPassword" class="block text-sm font-medium text-gray-700 mb-1">New Password</label>
          <input 
            type="password" 
            id="modalNewPassword" 
            formControlName="newPassword"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          <div *ngIf="passwordForm.get('newPassword')?.invalid && passwordForm.get('newPassword')?.touched" class="text-red-600 text-xs mt-1">
            Password must be at least 8 characters
          </div>
        </div>
        
        <div>
          <label for="modalConfirmPassword" class="block text-sm font-medium text-gray-700 mb-1">Confirm New Password</label>
          <input 
            type="password" 
            id="modalConfirmPassword" 
            formControlName="confirmPassword"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          <div *ngIf="passwordForm.errors?.['passwordMismatch'] && passwordForm.get('confirmPassword')?.touched" class="text-red-600 text-xs mt-1">
            Passwords do not match
          </div>
        </div>
        
        <div class="mt-6 flex justify-end space-x-3">
          <button 
            type="button" 
            (click)="closePasswordModal()" 
            class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500">
            Cancel
          </button>
          <button 
            type="submit" 
            class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
            [disabled]="passwordForm.invalid">
            Update Password
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Delete Account Confirmation Modal -->
<div *ngIf="showDeleteModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg shadow-xl w-full max-w-md">
    <div class="p-6 border-b border-gray-200">
      <h3 class="text-lg font-medium text-gray-900">Delete Account</h3>
    </div>
    <div class="p-6">
      <p class="text-gray-600 mb-6">
        Are you sure you want to delete your account? This action cannot be undone and all your data will be permanently removed.
      </p>
      
      <form [formGroup]="deleteAccountForm" (ngSubmit)="confirmDeleteAccount()" class="space-y-4">
        <div>
          <label for="deleteConfirmPassword" class="block text-sm font-medium text-gray-700 mb-1">Enter your password to confirm</label>
          <input 
            type="password" 
            id="deleteConfirmPassword" 
            formControlName="password"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          <div *ngIf="deleteAccountForm.get('password')?.invalid && deleteAccountForm.get('password')?.touched" class="text-red-600 text-xs mt-1">
            Password is required to confirm deletion
          </div>
        </div>
        
        <div class="flex items-center">
          <input 
            id="deleteConfirmation" 
            type="checkbox" 
            formControlName="confirmation"
            class="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
          <label for="deleteConfirmation" class="ml-2 block text-sm text-gray-700">
            I understand this action is permanent
          </label>
        </div>
        
        <div *ngIf="deleteError" class="p-3 bg-red-50 text-red-700 text-sm rounded-md">
          {{ deleteError }}
        </div>
        
        <div class="mt-6 flex justify-end space-x-3">
          <button 
            type="button" 
            (click)="closeDeleteModal()" 
            class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500">
            Cancel
          </button>
          <button 
            type="submit" 
            class="px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500"
            [disabled]="deleteAccountForm.invalid || !deleteAccountForm.get('confirmation')?.value">
            Permanently Delete Account
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Phone Verification Modal -->
<div *ngIf="showPhoneVerificationModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg shadow-xl w-full max-w-md">
    <div class="p-6 border-b border-gray-200">
      <h3 class="text-lg font-medium text-gray-900">Verify Phone Number</h3>
    </div>
    <div class="p-6">
      <p class="text-gray-600 mb-4">
        We've sent a verification code to {{ profileForm.value.phone }}. Please enter the code below to verify your phone number.
      </p>
      
      <form [formGroup]="phoneVerificationForm" (ngSubmit)="confirmPhoneVerification()" class="space-y-4">
        <div>
          <label for="verificationCode" class="block text-sm font-medium text-gray-700 mb-1">Verification Code</label>
          <div class="flex space-x-2">
            <input 
              *ngFor="let _ of [0,1,2,3,4,5]; let i = index" 
              type="text" 
              maxlength="1"
              [id]="'code-' + i"
              (input)="onVerificationCodeInput($event, i)"
              class="w-10 h-12 text-center text-xl font-semibold border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
          
          <div *ngIf="phoneVerificationForm.get('verificationCode')?.invalid && phoneVerificationForm.get('verificationCode')?.touched" class="text-red-600 text-xs mt-1">
            Please enter a valid verification code
          </div>
        </div>
        
        <div class="flex justify-between items-center text-sm">
          <button 
            type="button" 
            (click)="resendVerificationCode()" 
            class="text-blue-600 hover:text-blue-800"
            [disabled]="resendCodeTimer > 0">
            {{ resendCodeTimer > 0 ? 'Resend code in ' + resendCodeTimer + 's' : 'Resend code' }}
          </button>
          
          <span class="text-gray-500">Didn't receive the code?</span>
        </div>
        
        <div *ngIf="verificationError" class="p-3 bg-red-50 text-red-700 text-sm rounded-md">
          {{ verificationError }}
        </div>
        
        <div class="mt-6 flex justify-end space-x-3">
          <button 
            type="button" 
            (click)="closePhoneVerificationModal()" 
            class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500">
            Cancel
          </button>
          <button 
            type="submit" 
            class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
            [disabled]="phoneVerificationForm.invalid">
            Verify
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Success Toast Notification -->
<div *ngIf="showToast" 
     class="fixed bottom-4 right-4 px-6 py-3 bg-green-600 text-white rounded-lg shadow-lg flex items-center z-50 animate-fade-in-up">
  <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
  </svg>
  <span>{{ toastMessage }}</span>
</div>